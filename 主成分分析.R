##############
##主成分分析##
##############

#为了评价同济大学生的生殖健康状况，朱云国老师考察了同济大学31个专业的4个有关生殖健康指标（x1,x2,x3,x4）的得分，这4个指标的得分越高越好，它们各自反映了生殖健康的一个方面，为了能对这31个专业做出综合评价，试对其做主成分分析
#1）建立数据集
x1<-c(68.77,78.48,59.90,53.10,51.89,74.74,65.96,64.72,65.24,68.18,66.12,66.12,56.06,63.98,54.16,67.15,52.58,57.80,57.16,46.76,35.75,45.59,64.97,45.08,46.25,25.03,53.90,51.51,33.68,46.65,52.79)
x2<-c(78.46,86.25,77.57,63.77,66.26,84.64,81.36,68.66,77.99,87.18,90.59,90.59,68.52,61.16,69.44,95.20,73.65,65.15,79.58,67.70,60.10,50.51,67.34,22.13,33.77,13.72,79.80,40.68,32.75,48.39,49.66)
x3<-c(98.18,80.84,73.48,73.31,57.38,81.16,73.13,77.87,92.55,77.73,76.26,76.26,67.78,56.85,55.55,80.22,71.00,63.13,59.60,61.49,46.56,49.65,67.88,21.58,28.73,38.66,61.34,33.78,20.61,48.21,51.47)
x4<-c(87.13,98.95,78.49,52.12,71.78,75.23,79.84,72.00,92.62,76.15,72.30,72.30,73.89,64.65,66.21,82.53,76.68,71.40,62.64,69.31,64.47,66.80,70.24,41.11,71.24,30.00,69.64,45.87,59.29,63.51,29.61)

#2）主成分分析
pca<-princomp(cbind(x1,x2,x3,x4),cor=T)
eigen(cor(cbind(x1,x2,x3,x4)))#计算特征值
summary(pca,loading=T)

#3)综合评价
major<- 1:31
score_firstfactor<-pca$scores[,1]
sorted_result<-sort(score_firstfactor,index=T)$ix
cbind(major,score_firstfactor,sorted_result)

#4)主成分分析结果图形展示
biplot(pca)

